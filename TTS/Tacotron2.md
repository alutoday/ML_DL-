<h1 align="center">Tacotron 2: PhiÃªn Báº£n "Pro Max" Ra Máº¯t! ğŸš€</h1>

---

TÆ°á»Ÿng tÆ°á»£ng cuá»‘i nÄƒm 2017, sau thÃ nh cÃ´ng vang dá»™i cá»§a sáº£n pháº©m Ä‘áº§u tay, cÃ¡c nhÃ  sÃ¡ng láº­p cá»§a "Tacotron Inc." khÃ´ng ngá»§ quÃªn trÃªn chiáº¿n tháº¯ng. Há» ngay láº­p tá»©c há»p team láº¡i vÃ  tuyÃªn bá»‘: "Pháº£i lÃ m ra má»™t phiÃªn báº£n xá»‹n hÆ¡n ná»¯a! Ã‚m thanh pháº£i tháº­t nhÆ° ngÆ°á»i!"

Tháº¿ lÃ  Tacotron 2 ra Ä‘á»i, váº«n vá»›i triáº¿t lÃ½ "quáº³ng cho nÃ³ sÃ¡ch vÃ  bÄƒng, nÃ³ tá»± biáº¿t bÆ¡i", nhÆ°ng vá»›i má»™t sá»± thay Ä‘á»•i "chÃ­ máº¡ng".

## The Biggest Upgrade: Diva "WaveNet" LÃªn SÃ n! ğŸ¤âœ¨
Báº¡n cÃ²n nhá»› anh chÃ ng ca sÄ©/nghá»‡ nhÃ¢n Griffin-Lim á»Ÿ phiÃªn báº£n Ä‘áº§u khÃ´ng? Anh ta lÃ  má»™t thá»£ thá»§ cÃ´ng lÃ nh nghá», nhÃ¬n báº£n nháº¡c (spectrogram) lÃ  hÃ¡t ra Ä‘Æ°á»£c ngay. Ráº¥t giá»i, nhÆ°ng giá»ng hÃ¡t Ä‘Ã´i khi váº«n cÃ²n hÆ¡i "mÃ¡y mÃ³c", thiáº¿u cáº£m xÃºc.

Giá» Ä‘Ã¢y, "Tacotron Inc." Ä‘Ã£ sa tháº£i anh ta vÃ  chiÃªu má»™ má»™t siÃªu sao ca nháº¡c, má»™t diva Ä‘Ã­ch thá»±c tÃªn lÃ  WaveNet.

**Griffin-Lim (CÅ©):** Giá»‘ng má»™t nghá»‡ nhÃ¢n giÃ , lÃ m viá»‡c theo kinh nghiá»‡m, khÃ´ng cáº§n há»c há»i thÃªm. "ÄÆ°a báº£n nháº¡c Ä‘Ã¢y, tÃ´i hÃ¡t cho, Ä‘á»«ng há»i nhiá»u."

**WaveNet (Má»›i):** LÃ  má»™t thiÃªn tÃ i Ã¢m nháº¡c thá»±c thá»¥! CÃ´ áº¥y khÃ´ng chá»‰ hÃ¡t, mÃ  cÃ²n lÃ  má»™t máº¡ng lÆ°á»›i tháº§n kinh (neural network) riÃªng. CÃ´ áº¥y há»c cÃ¡ch biáº¿n báº£n nháº¡c thÃ nh Ã¢m thanh. CÃ´ áº¥y cÃ³ thá»ƒ "cáº£m" Ä‘Æ°á»£c giai Ä‘iá»‡u, thÃªm vÃ o nhá»¯ng rung cáº£m tinh táº¿, nhá»¯ng hÆ¡i thá»Ÿ tá»± nhiÃªn mÃ  khÃ´ng ai dáº¡y. CÃ´ áº¥y khÃ´ng pháº£i lÃ  má»™t "thá»£ hÃ¡t", cÃ´ áº¥y lÃ  má»™t NGHá»† SÄ¨.

=> Sá»± thay Ä‘á»•i nÃ y giá»‘ng nhÆ° viá»‡c báº¡n chuyá»ƒn tá»« nghe má»™t báº£n nháº¡c MIDI sang nghe má»™t báº£n giao hÆ°á»Ÿng Ä‘Æ°á»£c trÃ¬nh diá»…n bá»Ÿi dÃ n nháº¡c sá»‘ng. Cháº¥t lÆ°á»£ng Ã¢m thanh má»™t trá»i má»™t vá»±c!

## SÆ¡ Äá»“ Tá»• Chá»©c Má»›i cá»§a "Tacotron Inc. 2.0"
Vá» cÆ¡ báº£n, cÃ¡c phÃ²ng ban cá»‘t lÃµi váº«n giá»¯ nguyÃªn:

- PhÃ²ng PhÃ¢n TÃ­ch (Encoder)
- PhÃ²ng SÃ¡ng TÃ¡c (Decoder + Attention)
- PhÃ²ng Háº­u Ká»³ (Post-processing Network)

NhÆ°ng thay Ä‘á»•i lá»›n nháº¥t lÃ  phÃ²ng cuá»‘i cÃ¹ng:

**PhÃ²ng Thanh Nháº¡c WaveNet (Vocoder Network):** PhÃ²ng nÃ y giá» Ä‘Ã¢y khÃ´ng pháº£i lÃ  má»™t Ä‘á»‘i tÃ¡c thuÃª ngoÃ i ná»¯a, mÃ  lÃ  má»™t bá»™ pháº­n chÃ­nh thá»©c, má»™t thÃ nh viÃªn khÃ´ng thá»ƒ thiáº¿u cá»§a cÃ´ng ty. ToÃ n bá»™ há»‡ thá»‘ng Ä‘Æ°á»£c thiáº¿t káº¿ Ä‘á»ƒ "giao tiáº¿p" vÃ  "há»£p tÃ¡c" cháº·t cháº½ vá»›i Diva WaveNet.

## BÃ­ KÃ­p Luyá»‡n QuÃ¢n "Dá»‹ Há»£m" Cá»§a CÃ´ng Ty (Regularization)
Äá»ƒ Ä‘áº£m báº£o cÃ¡c nhÃ¢n viÃªn AI cá»§a mÃ¬nh khÃ´ng trá»Ÿ nÃªn lÆ°á»i biáº¿ng hay há»c váº¹t, "Tacotron Inc. 2.0" Ã¡p dá»¥ng hai chÃ­nh sÃ¡ch quáº£n lÃ½ nhÃ¢n sá»± cá»±c ká»³ láº¡ lÃ¹ng:

**Dropout (XÃ¡c suáº¥t 0.5):** DÃ nh cho cÃ¡c nhÃ¢n viÃªn bÃ¬nh thÆ°á»ng (Convolutional layers). Cá»© Ä‘ang lÃ m viá»‡c ngon lÃ nh, sáº¿p láº¡i chá»‰ ngáº«u nhiÃªn má»™t ngÆ°á»i vÃ  hÃ©t: "ÃŠ! Äi pha cÃ  phÃª cho cáº£ phÃ²ng!". NgÆ°á»i nÃ y sáº½ táº¡m thá»i "biáº¿n máº¥t", buá»™c nhá»¯ng ngÆ°á»i cÃ²n láº¡i pháº£i gá»“ng gÃ¡nh vÃ  tá»± tÃ¬m cÃ¡ch giáº£i quyáº¿t cÃ´ng viá»‡c. Äiá»u nÃ y giÃºp cáº£ team trá»Ÿ nÃªn máº¡nh máº½, linh hoáº¡t vÃ  khÃ´ng phá»¥ thuá»™c vÃ o báº¥t ká»³ cÃ¡ nhÃ¢n nÃ o.

**Zoneout (XÃ¡c suáº¥t 0.1):** DÃ nh cho cÃ¡c chuyÃªn gia cao cáº¥p (LSTM layers). Vá»›i nhá»¯ng nhÃ¢n váº­t quan trá»ng nÃ y, sáº¿p khÃ´ng Ä‘uá»•i Ä‘i pha cÃ  phÃª. Thay vÃ o Ä‘Ã³, sáº¿p sáº½ vá»— vai há» vÃ  nÃ³i: "NÃ y anh báº¡n, 5 phÃºt tá»›i ngá»“i yÃªn, 'zone out' Ä‘i, Ä‘á»«ng lÃ m gÃ¬ cáº£!". ChuyÃªn gia nÃ y sáº½ táº¡m thá»i "Ä‘Æ¡" ra, buá»™c cÃ¡c luá»“ng suy nghÄ© pháº£i Ä‘i theo nhá»¯ng con Ä‘Æ°á»ng má»›i máº» khÃ¡c. Viá»‡c nÃ y giÃºp há» khÃ´ng bá»‹ Ä‘i vÃ o lá»‘i mÃ²n vÃ  luÃ´n giá»¯ Ä‘Æ°á»£c sá»± sÃ¡ng táº¡o.

<p align="center">
  <img src="image-7.png" alt="regularization" width="70%">
</p>

<br>

---

## Encoder (PhÃ²ng PhÃ¢n TÃ­ch & MÃ£ HÃ³a ThÃ´ng Tin) ğŸ•µï¸â€â™‚ï¸
<p align="center">
  <img src="image-8.png" alt="encoder" width="70%">
</p>

Anh chÃ ng Encoder phiÃªn báº£n 2.0 nÃ y giá» Ä‘Ã¢y khÃ´ng cÃ²n lÃ  má»™t tay mÆ¡ ná»¯a, mÃ  Ä‘Ã£ trá»Ÿ thÃ nh má»™t chuyÃªn gia phÃ¢n tÃ­ch siÃªu háº¡ng. ÄÃ¢y lÃ  quy trÃ¬nh lÃ m viá»‡c má»›i cá»§a anh ta:

### BÆ°á»›c 1: Cáº¥p "CÄƒn CÆ°á»›c CÃ´ng DÃ¢n 512 Chiá»u" cho tá»«ng Chá»¯ CÃ¡i (Character Embedding) ğŸ’³
Náº¿u á»Ÿ phiÃªn báº£n cÅ©, má»—i chá»¯ cÃ¡i chá»‰ Ä‘Æ°á»£c cáº¥p má»™t cÃ¡i "mÃ£ váº¡ch" Ä‘Æ¡n giáº£n, thÃ¬ bÃ¢y giá», má»—i chá»¯ cÃ¡i khi Ä‘i vÃ o há»‡ thá»‘ng sáº½ Ä‘Æ°á»£c cáº¥p ngay má»™t cuá»‘n "CÄƒn cÆ°á»›c cÃ´ng dÃ¢n" siÃªu dÃ y, siÃªu chi tiáº¿t.

"Learned 512-d character embedding": Cuá»‘n cÄƒn cÆ°á»›c nÃ y cÃ³ tá»›i 512 má»¥c thÃ´ng tin (chiá»u khÃ´ng gian)! NÃ³ khÃ´ng chá»‰ ghi nháº­n chá»¯ Ä‘Ã³ lÃ  chá»¯ gÃ¬, mÃ  cÃ²n ghi láº¡i "tÃ­nh cÃ¡ch", "há» hÃ ng", "báº¡n bÃ¨" vÃ  tiá»m nÄƒng káº¿t há»£p cá»§a chá»¯ Ä‘Ã³ vá»›i cÃ¡c chá»¯ khÃ¡c. VÃ­ dá»¥, chá»¯ 'q' sáº½ cÃ³ má»™t má»¥c trong cÄƒn cÆ°á»›c ghi ráº±ng: "Ráº¥t thÃ­ch Ä‘i chung vá»›i chá»¯ 'u'".

=> Má»¥c Ä‘Ã­ch: GiÃºp há»‡ thá»‘ng cÃ³ má»™t cÃ¡i nhÃ¬n sÃ¢u sáº¯c vÃ  Ä‘a chiá»u vá» tá»«ng "viÃªn gáº¡ch" nhá» nháº¥t xÃ¢y nÃªn cÃ¢u nÃ³i.

### BÆ°á»›c 2: Biá»‡t Äá»™i "ThÃ¡m Tá»­ Ngá»¯ Cáº£nh" vÃ o cuá»™c (3 Lá»›p Convolutional Layers) ğŸ•µï¸â€â™‚ï¸
Sau khi cÃ³ cÄƒn cÆ°á»›c xá»‹n, há»“ sÆ¡ cá»§a cÃ¡c chá»¯ cÃ¡i sáº½ Ä‘Æ°á»£c chuyá»ƒn cho má»™t biá»‡t Ä‘á»™i thÃ¡m tá»­ tinh nhuá»‡ gá»“m 3 lá»›p.

"A stack of 3 convolutional layers... with shape 5Ã—1": TÆ°á»Ÿng tÆ°á»£ng cÃ³ 3 Ä‘á»™i thÃ¡m tá»­ xáº¿p hÃ ng ná»‘i Ä‘uÃ´i nhau.

Äá»™i 1 (TÃ¢n binh): Má»—i thÃ¡m tá»­ trong Ä‘á»™i nÃ y chá»‰ nhÃ¬n vÃ o má»™t nhÃ³m 5 chá»¯ cÃ¡i Ä‘á»©ng cáº¡nh nhau Ä‘á»ƒ tÃ¬m ra nhá»¯ng manh má»‘i cÆ¡ báº£n nháº¥t (vÃ­ dá»¥: "Ã , Ä‘Ã¢y lÃ  cá»¥m 'xin ch' nÃ y!").

Äá»™i 2 (Kinh nghiá»‡m): Dá»±a trÃªn bÃ¡o cÃ¡o cá»§a Äá»™i 1, Ä‘á»™i nÃ y sáº½ káº¿t ná»‘i cÃ¡c manh má»‘i nhá» láº¡i Ä‘á»ƒ tÃ¬m ra nhá»¯ng cá»¥m tá»« cÃ³ Ã½ nghÄ©a lá»›n hÆ¡n.

Äá»™i 3 (ChuyÃªn gia): NhÃ¬n vÃ o káº¿t quáº£ cá»§a Äá»™i 2 Ä‘á»ƒ tÃ¬m ra cÃ¡c cáº¥u trÃºc ngá»¯ phÃ¡p vÃ  ngá»¯ cáº£nh phá»©c táº¡p hÆ¡n trong cÃ¢u.

"Batch normalization and ReLU activations": Sau má»—i vÃ²ng Ä‘iá»u tra, cáº£ Ä‘á»™i sáº½ há»p láº¡i Ä‘á»ƒ "dá»n dáº¹p há»“ sÆ¡" (batch normalization - thá»‘ng nháº¥t cÃ¡c bÃ¡o cÃ¡o cho dá»… Ä‘á»c) vÃ  "chá»‘t háº¡ váº¥n Ä‘á»" (ReLU - quyáº¿t Ä‘á»‹nh manh má»‘i nÃ o lÃ  quan trá»ng cáº§n giá»¯ láº¡i, manh má»‘i nÃ o lÃ  rÃ¡c thÃ¬ vá»©t Ä‘i).

=> Má»¥c Ä‘Ã­ch: Thay vÃ¬ nhÃ¬n tá»«ng chá»¯ riÃªng láº», biá»‡t Ä‘á»™i nÃ y giÃºp há»‡ thá»‘ng hiá»ƒu Ä‘Æ°á»£c cÃ¡c cá»¥m tá»« vÃ  ngá»¯ cáº£nh cá»¥c bá»™ (nhÆ° bigram, trigram,...) má»™t cÃ¡ch hiá»‡u quáº£.

### BÆ°á»›c 3: "Sáº¿p Lá»›n" Äá»c XuÃ´i Äá»c NgÆ°á»£c Chá»‘t BÃ¡o CÃ¡o (Bi-directional LSTM) ğŸ§ 
Cuá»‘i cÃ¹ng, toÃ n bá»™ há»“ sÆ¡ vá»¥ Ã¡n Ä‘Ã£ Ä‘Æ°á»£c cÃ¡c thÃ¡m tá»­ phÃ¢n tÃ­ch sáº½ Ä‘Æ°á»£c trÃ¬nh lÃªn cho "Sáº¿p Lá»›n" - má»™t chuyÃªn gia cÃ³ siÃªu nÄƒng lá»±c Ä‘áº·c biá»‡t.

"A single bi-directional LSTM layer": Sáº¿p Lá»›n nÃ y khÃ´ng Ä‘á»c bÃ¡o cÃ¡o theo cÃ¡ch thÃ´ng thÆ°á»ng.

LÆ°á»£t Ä‘á»c xuÃ´i: Sáº¿p Ä‘á»c tá»« Ä‘áº§u Ä‘áº¿n cuá»‘i cÃ¢u Ä‘á»ƒ náº¯m báº¯t máº¡ch truyá»‡n tá»± nhiÃªn.

LÆ°á»£t Ä‘á»c ngÆ°á»£c: Ngay sau Ä‘Ã³, Sáº¿p láº¡i Ä‘á»c tá»« cuá»‘i cÃ¢u ngÆ°á»£c vá» Ä‘áº§u! Viá»‡c nÃ y giÃºp sáº¿p "ngá»™" ra nhá»¯ng Ã½ nghÄ©a áº©n sÃ¢u hoáº·c nhá»¯ng má»‘i liÃªn há»‡ mÃ  cÃ¡ch Ä‘á»c thÃ´ng thÆ°á»ng khÃ´ng thá»ƒ tháº¥y Ä‘Æ°á»£c. VÃ­ dá»¥, Ä‘á»c Ä‘áº¿n cuá»‘i cÃ¢u má»›i biáº¿t Ä‘Ã¢y lÃ  cÃ¢u há»i hay cÃ¢u kháº³ng Ä‘á»‹nh.

Sáº¿p Lá»›n nÃ y cÃ³ má»™t bá»™ nÃ£o siÃªu khá»§ng (512 units), má»™t ná»­a (256 units) chuyÃªn Ä‘á»ƒ Ä‘á»c xuÃ´i vÃ  ná»­a cÃ²n láº¡i (256 units) chuyÃªn Ä‘á»ƒ Ä‘á»c ngÆ°á»£c.

=> Má»¥c Ä‘Ã­ch: Táº¡o ra má»™t sá»± tháº¥u hiá»ƒu toÃ n diá»‡n vÃ  sÃ¢u sáº¯c nháº¥t vá» Ã½ nghÄ©a cá»§a cáº£ cÃ¢u vÄƒn, khÃ´ng bá» sÃ³t báº¥t ká»³ chi tiáº¿t nÃ o.

## Decoder + Attention Mechanism (PhÃ²ng SÃ¡ng TÃ¡c Ã‚m Nháº¡c) ğŸ¼
<p align="center">
  <img src="image-9.png" alt="decoder-attention" width="70%">
</p>

<br>

## NÃ¢ng cáº¥p lá»›n nháº¥t: GiÃ¡m Thá»‹ Giá» ÄÃ£ CÃ³ "GPS Äá»‹nh Vá»‹" (Location Sensitive Attention) ğŸ—ºï¸
Báº¡n cÃ²n nhá»› "GiÃ¡m Thá»‹ KhÃ³ TÃ­nh" á»Ÿ phiÃªn báº£n cÅ© khÃ´ng? Ã”ng ta chá»‰ biáº¿t dÃ­ Ä‘Ã¨n laser vÃ o tá»«ng chá»¯ Ä‘á»ƒ NhÃ  Soáº¡n Nháº¡c táº­p trung. NhÆ°ng Ä‘Ã´i khi Ã´ng ta cÅ©ng bá»‹ "lÃº", cÃ³ thá»ƒ chá»‰ Ä‘i chá»‰ láº¡i má»™t chá»— hoáº·c bá»‹ phÃ¢n tÃ¢m.

Giá» Ä‘Ã¢y, Ã´ng GiÃ¡m Thá»‹ Ä‘Ã£ Ä‘Æ°á»£c trang bá»‹ má»™t há»‡ thá»‘ng GPS siÃªu cáº¥p:

"Location Sensitive Attention": TrÆ°á»›c khi báº¯t Ä‘áº§u, Ã´ng GiÃ¡m Thá»‹ khÃ´ng chá»‰ nhÃ¬n vÃ o báº£n bÃ¡o cÃ¡o cá»§a Encoder, mÃ  cÃ²n tráº£i má»™t táº¥m báº£n Ä‘á»“ ra bÃ n. Má»—i láº§n Ã´ng dÃ­ Ä‘Ã¨n laser vÃ o má»™t chá»¯, Ã´ng sáº½ láº¥y bÃºt Ä‘Ã¡nh dáº¥u "X" vÃ o vá»‹ trÃ­ Ä‘Ã³ trÃªn báº£n Ä‘á»“.

Lá»£i Ã­ch: Ã”ng ta luÃ´n biáº¿t mÃ¬nh Ä‘Ã£ Ä‘i qua nhá»¯ng Ä‘Ã¢u. Äiá»u nÃ y giÃºp Ã´ng:

KhÃ´ng bao giá» láº·p láº¡i: Sáº½ khÃ´ng cÃ³ chuyá»‡n Ä‘á»c Ä‘i Ä‘á»c láº¡i má»™t tá»«.

Di chuyá»ƒn tuáº§n tá»±: LuÃ´n biáº¿t chá»¯ tiáº¿p theo cáº§n táº­p trung lÃ  chá»¯ nÃ o, giÃºp dÃ²ng cháº£y Ã¢m nháº¡c mÆ°á»£t mÃ  nhÆ° lÆ°á»›t trÃªn bÄƒng.

KhÃ´ng bá»‹ láº¡c: DÃ¹ cÃ¢u cÃ³ dÃ i vÃ  phá»©c táº¡p Ä‘áº¿n Ä‘Ã¢u, Ã´ng cÅ©ng khÃ´ng bao giá» bá»‹ "máº¥t dáº¥u".

## Quy TrÃ¬nh SÃ¡ng TÃ¡c Má»›i: Tá»‰ Má»‰ Tá»«ng Ná»‘t Nháº¡c ğŸ¶
DÃ¢y chuyá»n sáº£n xuáº¥t "báº£n Ä‘á»“ Ã¢m thanh" giá» Ä‘Ã¢y Ä‘Ã£ trá»Ÿ nÃªn tinh vi hÆ¡n ráº¥t nhiá»u.

Khá»Ÿi Ä‘á»™ng (<GO> frame & Pre-net): Sáº¿p gÃµ bÃºa ra hiá»‡u báº¯t Ä‘áº§u tá»« má»™t khoáº£ng láº·ng. NhÃ  Soáº¡n Nháº¡c láº¥y ná»‘t nháº¡c vá»«a Ä‘Æ°á»£c táº¡o ra á»Ÿ bÆ°á»›c trÆ°á»›c (hoáº·c khoáº£ng láº·ng náº¿u lÃ  Ä‘áº§u tiÃªn), cho qua má»™t cÃ¡i "mÃ¡y khá»Ÿi Ä‘á»™ng Ã½ tÆ°á»Ÿng" (Pre-net) Ä‘á»ƒ "má»“i" cho quÃ¡ trÃ¬nh sÃ¡ng táº¡o.

**Team-work Ä‘á»‰nh cao (Concatenation):**

GiÃ¡m Thá»‹ GPS chiáº¿u Ä‘Ã¨n laser vÃ o chá»¯ cáº§n phá»• nháº¡c vÃ  Ä‘Æ°a ra "chá»‰ thá»‹" cá»§a mÃ¬nh.

NhÃ  Soáº¡n Nháº¡c láº¥y "Ã½ tÆ°á»Ÿng má»“i" tá»« mÃ¡y khá»Ÿi Ä‘á»™ng vÃ  "chá»‰ thá»‹" cá»§a GiÃ¡m Thá»‹, dÃ¹ng bÄƒng dÃ­nh dÃ¡n chÃºng láº¡i vá»›i nhau.

Bá»™ NÃ£o 2 Táº§ng SiÃªu Khá»§ng (2 uni-directional LSTM layers): Máº©u giáº¥y dÃ¡n nÃ y Ä‘Æ°á»£c Ä‘Æ°a vÃ o bá»™ nÃ£o sÃ¡ng táº¡o cá»§a NhÃ  Soáº¡n Nháº¡c. Náº¿u ngÃ y xÆ°a nÃ£o anh ta chá»‰ cÃ³ 1 táº§ng, thÃ¬ giá» nÃ³ Ä‘Ã£ Ä‘Æ°á»£c nÃ¢ng cáº¥p lÃªn 2 táº§ng vá»›i sá»©c máº¡nh tÃ­nh toÃ¡n khá»•ng lá»“ (1024 units). Anh ta nghiá»n ngáº«m, phÃ¢n tÃ­ch vÃ ...

## Hai "CÃº HÃ­t" Táº¡o NÃªn Sá»± KhÃ¡c Biá»‡t! ğŸ’¥
ÄÃ¢y lÃ  lÃºc Ä‘iá»u ká»³ diá»‡u xáº£y ra. Thay vÃ¬ chá»‰ cho ra má»™t káº¿t quáº£, bá»™ nÃ£o cá»§a NhÃ  Soáº¡n Nháº¡c giá» Ä‘Ã¢y hoáº¡t Ä‘á»™ng song song vÃ  cho ra HAI Sáº¢N PHáº¨M cÃ¹ng lÃºc:

1. **Sáº£n pháº©m chÃ­nh: Ná»‘t Nháº¡c SiÃªu Chi Tiáº¿t ğŸ¼**  
"Predict the target spectrogram frame": Anh ta tá»‰ má»‰ viáº¿t ra duy nháº¥t Má»˜T ná»‘t nháº¡c (má»™t khung spectrogram).

Sá»± khÃ¡c biá»‡t chÃ­ máº¡ng: á» phiÃªn báº£n cÅ©, Ä‘á»ƒ cho nhanh, anh ta viáº¿t luÃ´n má»™t lÃºc cáº£ cá»¥m vÃ i ná»‘t nháº¡c. NhÆ°ng á»Ÿ phiÃªn báº£n 2.0, anh ta cáº©n tháº­n náº¯n nÃ³t tá»«ng ná»‘t má»™t. Äiá»u nÃ y giá»‘ng nhÆ° má»™t há»a sÄ© váº½ tá»«ng nÃ©t cá» tinh xáº£o thay vÃ¬ tÃ´ mÃ u theo máº£ng lá»›n. Cháº¥t lÆ°á»£ng Ã¢m thanh chi tiáº¿t vÃ  tá»± nhiÃªn hÆ¡n háº³n!

2. **Sáº£n pháº©m phá»¥: "Trá»£ LÃ½ Biáº¿t Äiá»u" & CÃ¡i NÃºt Dá»«ng ğŸ›‘**  
"Predict the probability that the output sequence has completed": CÃ¹ng lÃºc Ä‘Ã³, má»™t "trá»£ lÃ½" Ä‘á»©ng bÃªn cáº¡nh quan sÃ¡t vÃ  giÆ¡ má»™t táº¥m báº£ng Ä‘iá»ƒm.

Náº¿u cÃ¢u vÄƒn váº«n cÃ²n dÃ i, trá»£ lÃ½ giÆ¡ báº£ng 0% ("Cá»© tiáº¿p tá»¥c Ä‘i sáº¿p Æ¡i!").

Khi tháº¥y cÃ¢u vÄƒn sáº¯p káº¿t thÃºc, trá»£ lÃ½ báº¯t Ä‘áº§u giÆ¡ báº£ng Ä‘iá»ƒm cao dáº§n: 50%... 80%...

Khi cÃ¢u vÄƒn Ä‘Ã£ háº¿t Ã½, trá»£ lÃ½ giÆ¡ báº£ng 99.9% vÃ  hÃ©t to: "Dá»ªNG Láº I! Háº¾T VIá»†C Rá»’I Sáº¾P Æ I!"

Lá»£i Ã­ch: ÄÃ¢y lÃ  má»™t phÃ¡t minh thiÃªn tÃ i! Há»‡ thá»‘ng giá» Ä‘Ã¢y cÃ³ thá»ƒ tá»± Ä‘á»™ng nháº­n biáº¿t khi nÃ o nÃªn káº¿t thÃºc, thay vÃ¬ cá»© "hÃ¡t" mÃ£i má»™t cÃ¡ch ngá»› ngáº©n hoáº·c dá»«ng láº¡i Ä‘á»™t ngá»™t. Giá»ng nÃ³i trá»Ÿ nÃªn tá»± nhiÃªn nhÆ° con ngÆ°á»i, biáº¿t khi nÃ o cáº§n pháº£i ngáº¯t nghá»‰.

TÃ³m láº¡i quy trÃ¬nh sÃ¡ng tÃ¡c 2.0:

GiÃ¡m Thá»‹ GPS chá»‰ Ä‘iá»ƒm â¡ï¸ NhÃ  Soáº¡n Nháº¡c dÃ¹ng nÃ£o 2 táº§ng â¡ï¸ Viáº¿t ra 1 Ná»T NHáº C cá»±c xá»‹n + Nhá» Trá»£ LÃ½ kiá»ƒm tra xem CÃ“ NÃŠN Dá»ªNG khÃ´ng? â¡ï¸ Ná»‘t nháº¡c vá»«a táº¡o láº¡i Ä‘Æ°á»£c dÃ¹ng lÃ m "má»“i" cho vÃ²ng tiáº¿p theo... vÃ  cá»© tháº¿ láº·p láº¡i.

## Post-processing Network (PhÃ²ng Háº­u Ká»³ & Mix Nháº¡c) âœ¨
<p align="center">
  <img src="image-10.png" alt="post-net" width="70%">
</p>

<br>

Náº¿u PhÃ²ng SÃ¡ng TÃ¡c táº¡o ra má»™t báº£n nháº¡c hay, thÃ¬ phÃ²ng nÃ y sáº½ biáº¿n nÃ³ thÃ nh má»™t kiá»‡t tÃ¡c. HÃ£y coi Ä‘Ã¢y lÃ  má»™t "Spa 5 Sao Cao Cáº¥p" dÃ nh riÃªng cho Ã¢m thanh.

### Má»¥c TiÃªu: "ÄÃ¡nh BÃ³ng Kim CÆ°Æ¡ng" ğŸ’
Báº£n Ä‘á»“ Ã¢m thanh (mel-spectrogram) mÃ  "PhÃ²ng SÃ¡ng TÃ¡c" gá»­i qua Ä‘Ã£ ráº¥t xá»‹n rá»“i, giá»‘ng nhÆ° má»™t viÃªn kim cÆ°Æ¡ng thÃ´. Nhiá»‡m vá»¥ cá»§a phÃ²ng Háº­u Ká»³ lÃ  mÃ i giÅ©a, Ä‘Ã¡nh bÃ³ng Ä‘á»ƒ viÃªn kim cÆ°Æ¡ng Ä‘Ã³ trá»Ÿ nÃªn long lanh, hoÃ n háº£o khÃ´ng tÃ¬ váº¿t trÆ°á»›c khi Ä‘Æ°a cho Diva WaveNet thá»ƒ hiá»‡n.

### Quy TrÃ¬nh "Spa Ã‚m Thanh" 5 BÆ°á»›c (5 Convolution Layers)
Báº£n nháº¡c thÃ´ Ä‘Æ°á»£c Ä‘Æ°a vÃ o má»™t liá»‡u trÃ¬nh chÄƒm sÃ³c Ä‘áº·c biá»‡t gá»“m 5 phÃ²ng, má»—i phÃ²ng cÃ³ má»™t Ä‘á»™i ngÅ© chuyÃªn gia riÃªng.

"5 convolution layers... 512 filters with shape 5Ã—1": TÆ°á»Ÿng tÆ°á»£ng má»—i phÃ²ng spa cÃ³ 512 chuyÃªn gia tháº©m má»¹. Má»—i chuyÃªn gia chá»‰ táº­p trung vÃ o má»™t vÃ¹ng da ráº¥t nhá» (má»™t Ä‘oáº¡n nháº¡c dÃ i 5 ná»‘t) Ä‘á»ƒ "soi" vÃ  xá»­ lÃ½ tá»«ng lá»—i li ti nhÆ° ná»‘t phÃ´, Ã¢m rÃ¨, hay nhá»‹p Ä‘iá»‡u chÆ°a mÆ°á»£t. Há» cá»±c ká»³ tá»‰ má»‰!

"batch normalization": Sau khi ra khá»i má»—i phÃ²ng, báº£n nháº¡c sáº½ Ä‘Æ°á»£c Ä‘i qua khu vá»±c "thanh lá»c & cÃ¢n báº±ng". BÆ°á»›c nÃ y giá»‘ng nhÆ° viá»‡c rá»­a máº·t vÃ  cÃ¢n báº±ng láº¡i Ä‘á»™ pH cho da, Ä‘áº£m báº£o má»i thá»© Ä‘Æ°á»£c sáº¡ch sáº½, thá»‘ng nháº¥t trÆ°á»›c khi bÆ°á»›c vÃ o liá»‡u trÃ¬nh tiáº¿p theo. Äiá»u nÃ y giÃºp cÃ¡c lá»—i nhá» khÃ´ng bá»‹ cá»™ng dá»“n vÃ  trá»Ÿ nÃªn nghiÃªm trá»ng hÆ¡n.

"tanh activations": á» 4 phÃ²ng Ä‘áº§u tiÃªn, sau khi "chÄƒm sÃ³c da", cÃ¡c chuyÃªn gia sáº½ bÃ´i má»™t loáº¡i "serum cáº£m xÃºc" (tanh) giÃºp Ã¢m thanh trá»Ÿ nÃªn sá»‘ng Ä‘á»™ng, cÃ³ há»“n vÃ  biá»ƒu cáº£m hÆ¡n. PhÃ²ng cuá»‘i cÃ¹ng thÃ¬ khÃ´ng cáº§n, vÃ¬ Ä‘Ã³ lÃ  bÆ°á»›c hoÃ n thiá»‡n cuá»‘i cÃ¹ng rá»“i, chá»‰ cáº§n "chá»‘t háº¡" lÃ  xong!

### VÅ© KhÃ­ Tá»‘i ThÆ°á»£ng: "Lá»‘i Táº¯t KÃ½ á»¨c" (Residual Connections) ğŸ§ 
ÄÃ¢y chÃ­nh lÃ  bÃ­ quyáº¿t lÃ m nÃªn tÃªn tuá»•i cá»§a "Spa 2.0" vÃ  lÃ  nÃ¢ng cáº¥p vÆ°á»£t trá»™i so vá»›i phiÃªn báº£n cÅ©.

HÃ£y tÆ°á»Ÿng tÆ°á»£ng tháº¿ nÃ y:

Chá»¥p áº£nh "TrÆ°á»›c Khi Spa" ğŸ“¸: TrÆ°á»›c khi báº£n nháº¡c bÆ°á»›c vÃ o má»™t phÃ²ng spa nÃ o Ä‘Ã³, má»™t chiáº¿c mÃ¡y áº£nh sáº½ chá»¥p láº¡i hiá»‡n tráº¡ng "má»™c" cá»§a nÃ³.

Tiáº¿n hÃ nh "TÃºt TÃ¡t": CÃ¡c chuyÃªn gia trong phÃ²ng sáº½ thá»±c hiá»‡n cÃ´ng viá»‡c mÃ i giÅ©a cá»§a mÃ¬nh.

Soi GÆ°Æ¡ng So SÃ¡nh: Sau khi lÃ m xong, thay vÃ¬ cá»© tháº¿ Ä‘Æ°a sáº£n pháº©m má»›i Ä‘i tiáº¿p, há» sáº½ láº¥y sáº£n pháº©m vá»«a lÃ m xong Ä‘áº·t cáº¡nh táº¥m áº£nh "trÆ°á»›c khi spa".

Chá»‰ Giá»¯ Láº¡i CÃ¡i Tá»‘t HÆ¡n: Há» chá»‰ láº¥y pháº§n khÃ¡c biá»‡t, pháº§n cáº£i tiáº¿n vÃ  Ä‘áº¯p nÃ³ lÃªn báº£n gá»‘c.

Táº¡i sao pháº£i lÃ m váº­y?

Äiá»u nÃ y Ä‘á»ƒ Ä‘áº£m báº£o ráº±ng cÃ¡c chuyÃªn gia khÃ´ng "hÄƒng say" quÃ¡ mÃ  "chá»¯a lá»£n lÃ nh thÃ nh lá»£n quÃ¨". NÃ³ Ä‘áº£m báº£o ráº±ng káº¿t quáº£ cuá»‘i cÃ¹ng luÃ´n luÃ´n lÃ  báº£n gá»‘c cá»™ng thÃªm nhá»¯ng cáº£i tiáº¿n tÃ­ch cá»±c. Nhá» váº­y, cháº¥t lÆ°á»£ng Ã¢m thanh sáº½ chá»‰ cÃ³ tá»‘t lÃªn chá»© khÃ´ng bao giá» tá»‡ Ä‘i, dÃ¹ cÃ³ Ä‘i qua bao nhiÃªu lá»›p xá»­ lÃ½ Ä‘i ná»¯a.

TÃ³m láº¡i má»™t cÃ¡ch siÃªu ngáº¯n gá»n:

Post-Network chÃ­nh lÃ  má»™t spa 5 sao, nÆ¡i báº£n nháº¡c thÃ´ Ä‘Æ°á»£c má»™t Ä‘á»™i ngÅ© chuyÃªn gia "mÃ¡t-xa", "Ä‘áº¯p máº·t náº¡", "thanh lá»c" qua 5 bÆ°á»›c. BÃ­ quyáº¿t cá»§a há» lÃ  luÃ´n so sÃ¡nh sáº£n pháº©m "sau khi spa" vá»›i áº£nh gá»‘c Ä‘á»ƒ Ä‘áº£m báº£o chá»‰ giá»¯ láº¡i nhá»¯ng gÃ¬ tá»‘t Ä‘áº¹p nháº¥t!

## Vocoder
<p align="center">
  <img src="image-11.png" alt="vocoder-wavenet" width="70%">
</p>

Náº¿u Post-Network lÃ  má»™t spa 5 sao, thÃ¬ WaveNet chÃ­nh lÃ  nghá»‡ sÄ©/maestro thiÃªn tÃ i biáº¿n báº£n nháº¡c Ä‘Ã£ Ä‘Æ°á»£c Ä‘Ã¡nh bÃ³ng trÃªn giáº¥y thÃ nh má»™t mÃ n trÃ¬nh diá»…n Ã¢m thanh live lay Ä‘á»™ng lÃ²ng ngÆ°á»i.

### Nhiá»‡m Vá»¥: "Thá»•i Há»“n" VÃ o Báº£n Nháº¡c ğŸŒ¬ï¸ğŸ¶
WaveNet nháº­n láº¥y báº£n Ä‘á»“ Ã¢m thanh (mel-spectrogram) siÃªu Ä‘áº¹p tá»« phÃ²ng Háº­u Ká»³. NhÆ°ng Ä‘Ã³ váº«n chá»‰ lÃ  "xÃ¡c" cá»§a Ã¢m thanh. Nhiá»‡m vá»¥ cá»§a cÃ´ lÃ  "thá»•i há»“n" vÃ o Ä‘Ã³, biáº¿n nhá»¯ng chá»‰ dáº«n trÃªn giáº¥y thÃ nh sÃ³ng Ã¢m thanh thá»±c thá»¥, chi tiáº¿t Ä‘áº¿n tá»«ng mili giÃ¢y.

CÃ´ khÃ´ng hÃ¡t theo kiá»ƒu thÃ´ng thÆ°á»ng. CÃ´ KIáº¾N Táº O Ã¢m thanh. HÃ£y tÆ°á»Ÿng tÆ°á»£ng cÃ´ lÃ  má»™t nhÃ  Ä‘iÃªu kháº¯c, tá»‰ má»‰ táº¡c nÃªn tá»«ng gá»£n sÃ³ng cá»§a Ã¢m thanh má»™t cÃ¡ch chÃ­nh xÃ¡c tuyá»‡t Ä‘á»‘i.

### Tuyá»‡t Ká»¹ #1: "ThiÃªn LÃ½ NhÃ£n" Ã‚m Nháº¡c (Dilated Convolutions) ğŸ‘€
Äá»ƒ táº¡o ra Ã¢m thanh chÃ¢n thá»±c, WaveNet cáº§n má»™t kháº£ nÄƒng cáº£m thá»¥ Ã¢m nháº¡c phi thÆ°á»ng. CÃ´ sá»Ÿ há»¯u má»™t "con máº¯t thá»© ba" cho phÃ©p cÃ´ nhÃ¬n tháº¥u bá»‘i cáº£nh cá»§a báº£n nháº¡c.

"30 dilated convolution layers": HÃ£y tÆ°á»Ÿng tÆ°á»£ng WaveNet cÃ³ 30 cáº·p máº¯t.

Cáº·p máº¯t Ä‘áº§u tiÃªn chá»‰ nhÃ¬n vÃ o ná»‘t nháº¡c ngay sÃ¡t bÃªn cáº¡nh.

Cáº·p máº¯t thá»© hai nhÃ¬n xa hÆ¡n, cÃ¡ch 2 ná»‘t.

Cáº·p máº¯t thá»© ba nhÃ¬n xa hÆ¡n ná»¯a, cÃ¡ch 4 ná»‘t, rá»“i 8 ná»‘t...

Káº¿t quáº£: CÃ¹ng má»™t lÃºc, cÃ´ vá»«a cÃ³ thá»ƒ tháº¥y chi tiáº¿t cá»§a ná»‘t nháº¡c káº¿ tiáº¿p, vá»«a bao quÃ¡t Ä‘Æ°á»£c giai Ä‘iá»‡u cá»§a cáº£ má»™t Ä‘oáº¡n nháº¡c dÃ i phÃ­a sau. Äiá»u nÃ y giÃºp cÃ´ táº¡o ra Ã¢m thanh cÃ³ tÃ­nh liÃªn káº¿t, mÆ°á»£t mÃ  vÃ  tá»± nhiÃªn, chá»© khÃ´ng bá»‹ rá»i ráº¡c nhÆ° robot.

### Tuyá»‡t Ká»¹ #2: Báº£ng Pha Cháº¿ Ã‚m Thanh "Tháº§n Sáº§u" (Mixture of Logistic Distributions - MoL) ğŸ¨ğŸ§ª
ÄÃ¢y má»›i lÃ  bÃ­ máº­t kinh khá»§ng nháº¥t lÃ m nÃªn tÃªn tuá»•i cá»§a Diva WaveNet!

CÃ¡c ca sÄ© robot Ä‘á»i cÅ© (nhÆ° trong game 8-bit) khi táº¡o Ã¢m thanh, chÃºng chá»‰ cÃ³ má»™t bá»™ "bÃºt chÃ¬ mÃ u" vá»›i vÃ i mÃ u cÆ¡ báº£n Ä‘á»ƒ chá»n. Ã‚m thanh vÃ¬ tháº¿ ráº¥t thÃ´ vÃ  giáº£.

CÃ²n WaveNet thÃ¬ khÃ¡c. CÃ´ khÃ´ng dÃ¹ng bÃºt chÃ¬ mÃ u. CÃ´ lÃ  má»™t báº­c tháº§y pha cháº¿ vá»›i má»™t báº£ng mÃ u gá»“m 10 loáº¡i "sÆ¡n xÃ¡c suáº¥t" khÃ¡c nhau.

"10-component mixture of logistic distributions (MoL)": Vá»›i má»—i má»™t gá»£n sÃ³ng Ã¢m thanh siÃªu nhá» mÃ  cÃ´ cáº§n táº¡o ra, cÃ´ khÃ´ng chá»n má»™t giÃ¡ trá»‹ duy nháº¥t. Thay vÃ o Ä‘Ã³, cÃ´ lÃ m nhÆ° sau:

Láº¥y ra 10 lá» sÆ¡n (10 distributions).

Má»—i lá» sÆ¡n cÃ³ má»™t "mÃ u chá»§ Ä‘áº¡o" (mean), má»™t Ä‘á»™ "loang" (log scale) vÃ  má»™t "tá»· lá»‡ pha" (mixture weight) riÃªng.

CÃ´ káº¿t há»£p 10 lá» sÆ¡n nÃ y theo má»™t cÃ´ng thá»©c bÃ­ truyá»n, pha trá»™n chÃºng láº¡i vá»›i nhau.

Káº¿t quáº£? CÃ´ cÃ³ thá»ƒ táº¡o ra hÃ ng triá»‡u sáº¯c thÃ¡i Ã¢m thanh tinh vi mÃ  khÃ´ng má»™t bá»™ bÃºt chÃ¬ mÃ u nÃ o cÃ³ thá»ƒ lÃ m Ä‘Æ°á»£c. NÃ³ táº¡o ra sá»± phong phÃº, Ä‘á»™ sÃ¢u vÃ  nhá»¯ng rung Ä‘á»™ng cá»±c ká»³ tá»± nhiÃªn trong giá»ng nÃ³i.

### QuÃ¡ TrÃ¬nh Luyá»‡n CÃ´ng (Training)
LÃ m sao WaveNet biáº¿t cÃ¡ch pha cháº¿ "tháº§n sáº§u" nhÆ° váº­y? CÃ´ pháº£i luyá»‡n táº­p!

"Negative log-likelihood of the ground truth": QuÃ¡ trÃ¬nh luyá»‡n táº­p cá»§a cÃ´ lÃ  nghe Ä‘i nghe láº¡i giá»ng hÃ¡t cá»§a ca sÄ© ngÆ°á»i tháº­t (ground truth).

CÃ´ thá»­ "pha cháº¿" vÃ  táº¡o ra má»™t gá»£n sÃ³ng Ã¢m thanh cá»§a riÃªng mÃ¬nh.

Sau Ä‘Ã³, cÃ´ so sÃ¡nh nÃ³ vá»›i báº£n gá»‘c. Náº¿u khÃ¡c xa quÃ¡, há»‡ thá»‘ng sáº½ "pháº¡t" cÃ´ ráº¥t náº·ng (loss cao).

Bá»‹ pháº¡t Ä‘au, cÃ´ sáº½ tá»± rÃºt kinh nghiá»‡m vÃ  Ä‘iá»u chá»‰nh láº¡i cÃ´ng thá»©c pha cháº¿ cá»§a mÃ¬nh cho láº§n sau.

Cá»© nhÆ° váº­y hÃ ng triá»‡u láº§n, cÃ´ trá»Ÿ thÃ nh má»™t nghá»‡ sÄ© cÃ³ kháº£ nÄƒng tÃ¡i táº¡o giá»ng nÃ³i gáº§n nhÆ° hoÃ n háº£o.

TÃ³m láº¡i:

Vocoder (WaveNet) lÃ  má»™t Diva thiÃªn tÃ i, ngÆ°á»i sá»­ dá»¥ng "ThiÃªn LÃ½ NhÃ£n" Ä‘á»ƒ nhÃ¬n tháº¥u báº£n nháº¡c vÃ  dÃ¹ng "Báº£ng Pha Cháº¿ Ã‚m Thanh 10 Lá» SÆ¡n" Ä‘á»ƒ kiáº¿n táº¡o nÃªn tá»«ng gá»£n sÃ³ng Ã¢m thanh má»™t cÃ¡ch siÃªu thá»±c, mang láº¡i giá»ng nÃ³i tá»± nhiÃªn Ä‘áº¿n kinh ngáº¡c cho Tacotron 2.

---

## Cuá»™c Äáº¡i Chiáº¿n Tay ÄÃ´i: Tacotron 1 vs. Tacotron 2 ğŸ¥Š
HÃ£y cÃ¹ng Ä‘áº·t hai "nhÃ¢n viÃªn thiÃªn tÃ i" nÃ y lÃªn bÃ n cÃ¢n Ä‘á»ƒ xem ai hÆ¡n ai nhÃ©!

1. **Bá»™ NÃ£o ChÃ­nh (LSTM vs. GRU):**
   - **Tacotron 1:** DÃ¹ng anh chÃ ng **GRU**, thÃ´ng minh, nhanh nháº¹n, gá»n gÃ ng.
   - **Tacotron 2:** ChÆ¡i lá»›n, thuÃª háº³n "lÃ£o lÃ ng" **LSTM**. Ã”ng nÃ y cÃ³ má»™t cuá»‘n "sá»• tay ghi chÃ©p" riÃªng nÃªn nhá»› Ä‘Æ°á»£c nhá»¯ng ngá»¯ cáº£nh siÃªu dÃ i vÃ  phá»©c táº¡p, tuy hÆ¡i cá»“ng ká»nh nhÆ°ng bá»™ nhá»› "khá»§ng" hÆ¡n háº³n.

2. **Äá»™i NgÅ© PhÃ¢n TÃ­ch (CBHG vs. Convolutional Layers):**
   - **Tacotron 1:** Dá»±a vÃ o "siÃªu trá»£ lÃ½ Ä‘a tÃ i" **CBHG**, má»™t mÃ¬nh cÃ¢n team tá»« A-Z.
   - **Tacotron 2:** ChuyÃªn mÃ´n hÃ³a! Láº­p ra má»™t **"biá»‡t Ä‘á»™i thÃ¡m tá»­" (Convolutional layers)** chuyÃªn nghiá»‡p. Má»—i ngÆ°á»i má»™t viá»‡c, phá»‘i há»£p nhá»‹p nhÃ ng, hiá»‡u quáº£ vÃ  sÃ¢u sáº¯c hÆ¡n.

3. **Tá»‘c Äá»™ SÃ¡ng TÃ¡c (Reduction Factor):**
   - **Tacotron 1:** HÆ¡i "Äƒn gian", viáº¿t nháº¡c theo kiá»ƒu "vÆ¡ cáº£ cá»¥m", má»™t láº§n viáº¿t ra vÃ i ná»‘t nháº¡c cho nhanh.
   - **Tacotron 2:** Cá»±c ká»³ tá»‰ má»‰! Náº¯n nÃ³t viáº¿t **tá»«ng ná»‘t má»™t**. Tuy cháº­m hÆ¡n vá» lÃ½ thuyáº¿t nhÆ°ng cháº¥t lÆ°á»£ng chi tiáº¿t vÃ  tinh xáº£o hÆ¡n gáº¥p bá»™i.

4. **Nghá»‡ SÄ© TrÃ¬nh Diá»…n (Griffin-Lim vs. WaveNet):**
   - **Tacotron 1:** ThuÃª "anh thá»£ hÃ¡t" **Griffin-Lim** lÃ nh nghá», hÃ¡t Ä‘Ãºng nháº¡c nhÆ°ng hÆ¡i khÃ´ khan.
   - **Tacotron 2:** ChiÃªu má»™ "Diva thiÃªn tÃ i" **WaveNet**, ngÆ°á»i khÃ´ng chá»‰ hÃ¡t mÃ  cÃ²n "thá»•i há»“n" vÃ o báº£n nháº¡c. ÄÃ¢y lÃ  nÃ¢ng cáº¥p **Äƒn tiá»n nháº¥t**!

5. **Loáº¡i Báº£n Nháº¡c (Linear vs. Mel Spectrogram):**
   - **Tacotron 1:** Váº½ ra báº£n nháº¡c kiá»ƒu "ká»¹ thuáº­t" (Linear), ghi láº¡i táº¥t cáº£ táº§n sá»‘, ká»ƒ cáº£ nhá»¯ng cÃ¡i tai ngÆ°á»i khÃ´ng nghe rÃµ.
   - **Tacotron 2:** Váº½ báº£n nháº¡c kiá»ƒu "tÃ¢m lÃ½ há»c" (Mel), táº­p trung vÃ o nhá»¯ng táº§n sá»‘ mÃ  tai ngÆ°á»i nháº¡y cáº£m nháº¥t. ThÃ´ng minh vÃ  hiá»‡u quáº£ hÆ¡n!

---

## KhÃ³a Huáº¥n Luyá»‡n Äáº·c Biá»‡t & Lá»… Tá»‘t Nghiá»‡p ğŸ†
QuÃ¡ trÃ¬nh "Ä‘Ã o táº¡o" Tacotron 2 cÅ©ng chuyÃªn nghiá»‡p hÆ¡n háº³n, chia lÃ m 2 giai Ä‘oáº¡n rÃµ rá»‡t:

- **Giai Ä‘oáº¡n 1: Luyá»‡n "LÃ½ Thuyáº¿t" cho Team SÃ¡ng TÃ¡c:** ToÃ n bá»™ Ä‘á»™i ngÅ© tá»« Encoder Ä‘áº¿n Post-Network (trá»« Diva WaveNet) Ä‘Æ°á»£c nhá»‘t vÃ o phÃ²ng Ä‘á»ƒ luyá»‡n táº­p cÃ¡ch biáº¿n chá»¯ thÃ nh báº£n nháº¡c hoÃ n háº£o.
- **Giai Ä‘oáº¡n 2: Luyá»‡n "Thá»±c HÃ nh" cho Diva:** Sau khi Ä‘Ã£ cÃ³ nhá»¯ng báº£n nháº¡c siÃªu cháº¥t lÆ°á»£ng, há» má»›i Ä‘Æ°a cho Diva WaveNet Ä‘á»ƒ cÃ´ luyá»‡n táº­p cÃ¡ch "thá»•i há»“n" vÃ o Ä‘Ã³. Giai Ä‘oáº¡n nÃ y cáº§n sá»©c máº¡nh khá»§ng khiáº¿p, pháº£i huy Ä‘á»™ng tá»›i **32 GPU** (nhÆ° má»™t dÃ n nháº¡c 32 ngÆ°á»i há»— trá»£ Diva luyá»‡n giá»ng).

### Káº¿t Quáº£ Ká»³ Thi Tá»‘t Nghiá»‡p (MOS - Mean Opinion Score):
ÄÃ¢y lÃ  lÃºc "khÃ¡n giáº£" (ngÆ°á»i nghe tháº­t) cháº¥m Ä‘iá»ƒm Ä‘á»™ tá»± nhiÃªn cá»§a giá»ng nÃ³i trÃªn thang 5.

| ThÃ­ Sinh | Äiá»ƒm BÃ¬nh Chá»n (MOS) | Lá»i BÃ¬nh HÃ i HÆ°á»›c |
| :--- | :---: | :--- |
| **Giá»ng NgÆ°á»i Tháº­t (Ground Truth)** | **4.58** | ğŸ‘‘ "Báº£n gá»‘c khÃ´ng thá»ƒ chÃª vÃ o Ä‘Ã¢u Ä‘Æ°á»£c!" |
| **Tacotron 2** | **4.53** | ğŸ¥ˆ **"Ã QUÃ‚N SÃT NÃšT!** HÃ¡t hay Ä‘áº¿n má»©c suÃ½t lá»«a Ä‘Æ°á»£c cáº£ ban giÃ¡m kháº£o!" |
| WaveNet (Ä‘á»©ng má»™t mÃ¬nh) | 4.21 | ğŸ¥‰ "Diva hÃ¡t ráº¥t hay, nhÆ°ng khÃ´ng cÃ³ nháº¡c sÄ© tá»‘t thÃ¬ váº«n chÆ°a Ä‘á»‰nh." |
| Tacotron 1 | 3.82 | ğŸ… "ThiÃªn tÃ i Ä‘á»i Ä‘áº§u, ráº¥t Ä‘Ã¡ng ná»ƒ nhÆ°ng Ä‘Ã£ Ä‘áº¿n lÃºc vá» hÆ°u." |
| Parametric (Äá»‘i thá»§ khÃ¡c) | 3.69 | "Giá»ng hÃ¡t á»•n, nhÆ°ng váº«n nghe ra mÃ¹i robot." |
| Concatenative (Äá»‘i thá»§ khÃ¡c) | 4.09 | "Giá»ng trong tráº»o nhÆ°ng Ä‘Ã´i khi hÆ¡i giáº­t cá»¥c." |

=> **Káº¿t luáº­n:** Tacotron 2 Ä‘Ã£ táº¡o ra má»™t cÃº sá»‘c lá»›n, Ä‘áº¡t Ä‘iá»ƒm sá»‘ gáº§n nhÆ° **cháº¡m nÃ³c** so vá»›i giá»ng ngÆ°á»i tháº­t, chÃ­nh thá»©c trá»Ÿ thÃ nh "Ã”ng Vua" má»›i cá»§a lÃ ng tá»•ng há»£p giá»ng nÃ³i!

---

## PhÃ²ng ThÃ­ Nghiá»‡m "Lá»¡ May ThÃ¬ Sao?" (Ablation Study) ğŸ”¬
CÃ¡c nhÃ  khoa há»c khÃ´ng dá»«ng láº¡i á»Ÿ Ä‘Ã³. Há» cÃ²n "nghá»‹ch ngá»£m" báº±ng cÃ¡ch thay Ä‘á»•i má»™t vÃ i bá»™ pháº­n cá»§a Tacotron 2 Ä‘á»ƒ xem chuyá»‡n gÃ¬ sáº½ xáº£y ra.

- **ThÃ­ nghiá»‡m 1: "Cho Diva há»c váº¹t thÃ¬ sao?"**
  - **Ká»‹ch báº£n:** Báº¯t Diva WaveNet chá»‰ luyá»‡n táº­p vá»›i báº£n nháº¡c cá»§a ngÆ°á»i tháº­t (ground truth), sau Ä‘Ã³ quáº³ng cho cÃ´ áº¥y báº£n nháº¡c do team Tacotron 2 sÃ¡ng tÃ¡c.
  - **Káº¿t quáº£:** Diva bá»‹ "khá»›p"! CÃ´ phÃ n nÃ n: "Báº£n nháº¡c nÃ y hÆ¡i 'láº¡', khÃ´ng giá»‘ng cÃ¡i tÃ´i Ä‘Æ°á»£c há»c!". Cháº¥t lÆ°á»£ng Ã¢m thanh tá»‡ Ä‘i.
  - **BÃ i há»c:** Nháº¡c sÄ© vÃ  ca sÄ© pháº£i **luyá»‡n táº­p cÃ¹ng nhau** thÃ¬ má»›i thÃ nh má»™t cáº·p Ä‘Ã´i hoÃ n háº£o Ä‘Æ°á»£c.

<p align="center">
  <img src="image-12.png" alt="ablation-1" width="70%">
</p>

- **ThÃ­ nghiá»‡m 2: "DÃ¹ng láº¡i báº£n nháº¡c cÅ© (Linear) thÃ¬ sao?"**
  - **Ká»‹ch báº£n:** Báº¯t Tacotron 2 táº¡o ra báº£n nháº¡c kiá»ƒu "ká»¹ thuáº­t" cá»§a Tacotron 1.
  - **Káº¿t quáº£:** Cháº³ng khÃ¡c biá»‡t nhiá»u!
  - **BÃ i há»c:** Diva WaveNet quÃ¡ "bÃ¡ Ä‘áº¡o"! ÄÆ°a cho cÃ´ áº¥y loáº¡i báº£n nháº¡c nÃ o, cÃ´ áº¥y cÅ©ng cÃ³ thá»ƒ biáº¿n nÃ³ thÃ nh má»™t kiá»‡t tÃ¡c. Váº¥n Ä‘á» khÃ´ng náº±m á»Ÿ báº£n nháº¡c, mÃ  lÃ  á»Ÿ tÃ i nÄƒng cá»§a ca sÄ©.

<p align="center">
  <img src="image-13.png" alt="ablation-2" width="70%">
</p>

- **ThÃ­ nghiá»‡m 3: "Báº¯t Diva hÃ¡t vá»›i dÃ n nháº¡c 'mini' thÃ¬ sao?"**
  - **Ká»‹ch báº£n:** Giáº£m bá»›t sá»©c máº¡nh cá»§a WaveNet, tá»« 30 lá»›p "thiÃªn lÃ½ nhÃ£n" xuá»‘ng chá»‰ cÃ²n 12 lá»›p.
  - **Káº¿t quáº£:** Cháº¥t lÆ°á»£ng váº«n ráº¥t cao!
  - **BÃ i há»c:** WaveNet khÃ´ng chá»‰ máº¡nh mÃ  cÃ²n cá»±c ká»³ hiá»‡u quáº£. CÃ´ khÃ´ng cáº§n quÃ¡ nhiá»u "Ä‘á»“ chÆ¡i" xá»‹n sÃ² Ä‘á»ƒ táº¡o ra Ã¢m thanh Ä‘á»‰nh cao. ÄÃºng lÃ  Ä‘áº³ng cáº¥p cá»§a má»™t siÃªu sao!

<p align="center">
  <img src="image-14.png" alt="ablation-3" width="70%">
</p>
